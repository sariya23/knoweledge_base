## Логический бэкап
При логическом бекапе у нас сохраняются sql команды, которые будут выполнятся если мы захотим этот бекап загрузить. Это гибкий подход, так как мы можем выбрать что оставлять, а что нет. Но если БД будет большой, то такой бекап будет выполнятся очень долго. Также такой вид бекапа совместим с разными версиями postgres
Для логического бекапа есть утилита `pg_dump` для дампа и `pg_restore` для восстановления.
Бекап
```shell
pg_dump -U username -d database_name -j8 -Fc -f backup.dump
```
`j8` - сколько ядер задействовать
`Fc` - сжать
`f` - куда положить бекап
Восстановление
```shell
pg_restore -U username -d new_database_name -j8 -Fc backup.dump
```
Вот, обычный sql в файле
![[Pasted image 20250613123724.png]]
## Физический бекап
При физическом бекапе сохраняется файловая структура БД. Менее гибкая, так как копируется ВСЕ (даже статистика) и точка, а также нет совместимости с разными версиями постгреса. На большой БД работает гораздно быстрее чем логический бекап, так как идет по сути копирование файлов
Для этого есть утилита `pg_basebackup`.
Бекап
```shell
pg_basebackup -U username -D /backup/ -F tar -z -P
```
## Архивирование WAL
При архивировании WAL можно постоянно бекапить данные. То есть не переодически запускать, а в реальном времени