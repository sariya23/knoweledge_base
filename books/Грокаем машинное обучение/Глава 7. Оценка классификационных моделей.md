## Метрики
**Достоверность**(accuracy) - кол-во раз, когда модель верно сделал прогноз. Это метрика самая простая, но не очень точная. Достоверность может быть 100%, потому что модель классифицирует все метки как положительные 
В контексте классификационных моделей есть различные типы ошибок. Предположим, мы прогнозируем болен человек или нет
- ложноположительный результат - человек не болен, но модель спрогнозирована, что болен
- ложноотрицательный результат - человек болен, но модель спрогнозировала, что здоров
- истинно положительный результат - человек болен и модель спрогнозировала, что он болен
- истинно отрицательный результат - человек не болен м модель спрогнозировала, что он не болен
Вся пляска с метриками классификационных моделей идет вокруг этих понятий. 
Эти понятия часто иллюстрируются в виде матрицы неточностей (confuse matrix)
![[Pasted image 20250404152142.png]]
### Полнота=чувствительность(recall)
**Полнота** - это метрика, которая определяет долю правильных прогнозов среди точек с положительной меткой
$$
полнота=\frac{TPs}{TPs+FNs}
$$
Полноту можно понимать так. Есть завод авто, который выпустил машины с серьезным недостатком. Им нужно найти и отозвать все неисправные машины. Если отберут те машины, которые оказались исправными, то просто вернут их. Полнота состоит в том, чтобы найти все примеры с положительной меткой.
Эта метрика проверяет, насколько хорошо модель справляется с ложноотрицательными результатами.
### Точность(precision)
Точность проверяет, насколько модель хорошо справляется с ложноположительными результатами. 
**Точность** - принимает в расчет только не точки, которые были помечены как положительные и определяет сколько среди них истинно положительных
$$
точность=\frac{TPs}{TPs+FPs}
$$

Продолжая пример с машинами, нам могут сказать, что мы отправляем слишком много машин и нас просят отправлять только те, что *точно* неисправны и ничего страшного, если мы пропустим какие-то из них
### F-score
F-score объединяет полноту и точность. Обычно нам нужно и полнота и точность, просто в разных мерах. F-score сопровождается параметром $\beta$. Когда $\beta=1$, то это называется $F_1$-метрикой
Мы не можем просто усреднить эти 2 метрики, так как среднее между 50% полноты и 100% точности будет 75%. Хотя 50% для полноты - маловато. Нужен показатель, который ведет себя как среднее, но ближе к минимальному. Это - среднее гармоническое. И метрика F1 это как раз среднее гармоническое между точностью и полнотой
$$
F_1=\frac{2*accuracy*recall}{precision + recall}
$$
Теперь добавим $\beta$. Она действует как циферблат, определяя, что важнее.
$$
F_\beta=\frac{(1+\beta)^2*precision*recall}{\beta^2*precision+recall}
$$
Чем меньше $\beta$, тем более много внимания уделяется точности и меньше полноте. Чем $\beta$ больше, тем более много внимания уделяется полноте.
![[Pasted image 20250404162058.png]]

## Какую метрику выбрать?
Все зависит от задачи. Мы должны решить, какая ошибка будет стоить дороже - ложноположительная или ложноотрицательная. 
Предположим, что есть классификатор, определяющий болен человек или нет. В таком случае, если мы отправим больного человека домой (ложноотрицательный), то это будет фиаско. Тут мы фокусируемся на полноте. 
Если же это какой-то спам фильтр, то тут большее внимания надо уделить точности
## Кривая ROC
Прежде чем перейти кривой, нужная еще одна метрика
**Избирательность** - способность определять точки с отрицательной меткой
$$
избирательность=\frac{TNs}{TNs+FNs}
$$
В классификаторах мы часто выбираем какое-то пороговое значение. Пороговое значение может быть любым. Процедура построения кривой заключается в том, чтобы менять порог от 0 до 1 и регистрировать значения избирательности и чувствительности. 
Рассмотрим 3 значения для порога
![[Pasted image 20250404155059.png]]
И наносим значения на график
![[Pasted image 20250404155349.png]]
А вот показателем, насколько модель хороша, является площадь под кривой - AUC
![[Pasted image 20250404155448.png]]
Худшее, что можем показать модель - AUC 0.5, так как она классифицирует точки 50 на 50. AUC же 0 значит, что модель вообще не можем ничего распределить. Но это неплохо. Если мы знаем, что она всегда ошибается, значит достаточно просто инвертировать ее результат
### Как принимать решение с помощью кривой
![[Pasted image 20250404155836.png]]
Если хочется, чтобы модель обладала высокой чувствительностью, то просто двигаем пороговое значение ближе к нулю, пока не доберемся до точки на кривой, которая нам нужна
![[Pasted image 20250404160027.png]]
## Как запомнить метрики?
![[Pasted image 20250404160105.png]]
