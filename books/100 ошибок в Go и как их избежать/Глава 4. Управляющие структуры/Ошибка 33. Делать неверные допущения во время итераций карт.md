[[100 ошибок в Go и как их избежать]]

При работе с картой не стоит полагаться на следующее:
- На то, что данные упорядочиваются по ключам
- На то, что порядок вставки сохранится
- На детерминированность порядка итераций

Вот с последним подробнее
```go
func main() {
    m := map[int]bool{
        0: true,
        1: false,
        2: true,
    }
    for k, v := range m {
        if v {
            m[10+k] = true
        }
    }
    fmt.Println(m)
}
```
Этот код будет выводить каждый раз разные результаты:
```
map[0:true 1:false 2:true 10:true 12:true 20:true 22:true 30:true 32:true]
map[0:true 1:false 2:true 10:true 12:true 20:true 22:true 30:true 32:true 40:true]
map[0:true 1:false 2:true 10:true 12:true 20:true 22:true]
```
Когда элемент карты добавляется к карте во время итерации, он может либо создан, либо нет при последующей итерации.

Эту проблему можно решить копированиев карты. Итерироваться по оригинальной карте, а добавлять в копию:
```go
m := map[int]bool{
	0: true,
	1: false,
	2: true,
}

m2 := copyMap(m)

for k, v := range m {
	m2[k] = v
	if v {
		m2[10 + k] = true
	}
}
```