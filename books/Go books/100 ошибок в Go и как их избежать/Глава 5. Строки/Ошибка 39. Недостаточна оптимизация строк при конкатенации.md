[[100 ошибок в Go и как их избежать]]

Конкатенация строк через `+=` на больших данных имеет низкую производительность, так как при добавлении символа исходная строка копируется и повторение этого действия займет много времени. Поэтому лучше использовать `strings.Builder`.
```go
    sb := strings.Builder{}
    for _, v := range values {
        _, _ = sb.WriteString(v)
    }
    return sb.String()
```
Этот метод никогда не вернет ошибку. Он возвращает `nil`, так как должен удовлетворять интерфейсу `io.StringerWrite`
За билдером стоит срез байт, поэтому при добавлении строки вызывается `append`. Это приводит к двум проблемам. Во-первых это небезопасно при конкурентности, так как может произойти состояние гонки. Во-вторых так как под билдером стоит срез, то при переполнении емкости, происходит копирование значений среза. Можно вызвать метод `sb.Grow`, чтобы зарезервировать память под итоговую строку:
```go
    total := 0
    for i := 0; i < len(values); i++ {
        total += len(values[i])
    }
    sb := strings.Builder{}
    sb.Grow(total)
    for _, v := range values {
        _, _ = sb.WriteString(v)
    }
    return sb.String()
```
Билдер очень эффективный. Эффективнее Join даже
![[Pasted image 20240904154611.png]]

В общем, когда нужно склеить большое кол-во строк - надо юзать билдер