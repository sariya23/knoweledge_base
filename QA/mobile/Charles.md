[[mobile]]

## Настройка (Win)
Для начала нужно установить сертификаты. Это нужно, чтобы Charles мог расшифровывать https трафик, а браузер доверял ему
![[Pasted image 20250222131954.png]]
Далее выбираем Установить сертификат -> локальный компьютер -> поместить все сертификаты в одном месте -> Доверенные корневые центры сертификации
После установки сертификата запросы и ответы все равно будут зашифрованы. Чтобы их расшифровать, нужно зайти в Proxy -> SSL Proxying Settings и проксировать все хосты
![[Pasted image 20250222132420.png]]

## Настройка для iPhone
Нужно подключить телефон к той же сети, что и ПК. В Настройках этой Сети нужно выставить ручной прокси с таким IP и портом, который будет указан тут
![[Pasted image 20250222133407.png]]
Далее на телефоне перейти на chls.pro/ssl и установить сертификат. Потом перейти в Настройки -> Профиль установлен и уставить этот сертификат. Далее перейти в Настройки -> Основные -> Об этом устройстве -> Доверия сертификатам и доверять сертификату charles.
Если по ссылке скачивание не происходит, то нужно скачать файл сертификата с компа и перекинуть его на телефон, а потом через файлы установить
![[Pasted image 20250222133538.png]]
## Функциональность
### Подмена данных
#### Breakpoint
С помощью инструмента breakpoint можно остановить запрос на моменте его отправки или на моменте получения ответа от сервера, чтобы подменить какие-то данные. 
Использовать в случаях:
- Тестирование API
- Взлом и исследование безопасности, например менять токены или заголовки
- Проверка, как сервер реагирует на невалидные данные
Но нужно каждый раз руками все подменять.
![[Pasted image 20250222140057.png]]
#### Rewrite
Делает примерно тоже самое, но автоматически. Можно задать правило, что, например, при запросе к такому-то серверу будет всегда меняться код ответа. Например, если у нас нет телефона под iOS, но мы хотим протестить поведение на сафари, то можно настроить правило, чтобы при всех запросах подменялся user-agent на iPhone.
![[Pasted image 20250222140438.png]]
#### Map local
Map local позволяет использовать локальные файлы, как будто они являются частью сервера. Например, мы можем подменять целые json-ответы, чтобы посмотреть, что произойдет
![[Pasted image 20250222140642.png]]

| Функция                | Map Local                                      | Map Remote                                         | Rewrite                      | Breakpoint                                     |
| ---------------------- | ---------------------------------------------- | -------------------------------------------------- | ---------------------------- | ---------------------------------------------- |
| **Что делает?**        | Подменяет файлы сервера на локальные           | Перенаправляет на другой сервер                    | Автоматически меняет запросы | Останавливает выполнение запроса для изменения |
| **Когда использовать** | Для замены файлов css, html, js                | Для подмены серверов. Например с прода на тестовый | Для автоизменения запросов   | Для ручного редактирования запросов            |
| **Пример**             | Тестировать новые стили без загрузки на сервер | Перенаправить трафик с прода на стенд              | Менять user-agent            | Изменить какой-то параметр                     |
### Proxy
#### Throttle Settings
![[Pasted image 20250222160255.png]]
Можно задать настройки для скорости соединения. Также можно сразу выбрать готовый пресет, например 3G, 4G
- Bandwidth - максимальная скорость
- Utilisation - доля общей пропускной способности, которая может быть предоставлена пользователю
- Latency - задержка
- MTU - максимальный размер пакета, который можно передать за раз
- Reliability - мера вероятности, что соединение не удастся
- Stability - вероятность, что соединение будет нестабильным

### Tools
#### Map remote
Перенаправляет запросы с одного URL на другой. 
#### Block List
Блокирует определённые доменные имена. Можно либо разрывать соединение, либо выбрасывать 403 код.