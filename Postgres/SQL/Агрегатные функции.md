[[Postgres]]
- Внутри функций `AVG`, `COUNT`, `SUM` можно использовать `DISTINCT` чтобы агреггировать только уникальные значения
- Внутри агрегатных функций (у `count` точно) можно писать условия
```sql
select
	count(case when weekday(submit_date) in (5, 6) then 1 end) weekend_count,
	count(case when weekday(submit_date) not in (5, 6) then 1 end) working_count
from Actions;
```
И можно даже так:
```sql
select 
    monthname(order_date) month,
    count(case when invoice > 20 then 1 end) order_count,
    count(distinct case when invoice > 20 then customer_id end) customer_count
from Orders
group by month;
```
Последний `count` считает кол-во уникальных клиентов , у которых есть заказы больше чем на 20 уед