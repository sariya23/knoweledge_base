[[Airflow]]
С помощью питоновских циклов можно генерировать задачи и даги
```python
from airflow import DAG
from airflow.operators.dummy_operator import DummyOperator
from airflow.utils.dates import days_ago

dag = DAG('0_Examples_5_7_1_task_generate', schedule_interval=None, start_date=days_ago(1),tags=['examples'])

task_list = list()
for i in range(0, 10):
    task_list.append(DummyOperator(task_id=f'task_{i}', dag=dag))
    if i:
        task_list[i-1] >> task_list[i]
```
И даги
```python
from airflow import DAG
from airflow.operators.dummy_operator import DummyOperator
from airflow.utils.dates import days_ago


def create_dag(dag_id,
               dag_number,
               default_args,
               schedule='@daily'):
    dag = DAG(dag_id,
              schedule_interval=schedule, 
              default_args=default_args,
              tags=['examples'])
    with dag:
        t1 = DummyOperator(task_id=f'task', dag=dag)
    return dag  

for dag_number in range(1, 4):
    dag_id = f'0_Examples_5_7_2_dag_generate_{dag_number}'  
    default_args = {'owner': 'airflow',
                    'start_date': days_ago(1)
                    }  
    globals()[dag_id] = create_dag(dag_id, dag_number, default_args)
```
`global()` возвращает глобальный словарь имен