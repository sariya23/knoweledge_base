[[Airflow]]
Airflow позволяет отправлять нотификации на email, tg, discord в случае заданного статуса выполнения задачи. 
Для этого в default_args можно передать такие ключи с колбэками:
- `on_success_callback: context` - вызов функции при успешном выполнении задачи
- `on_failure_callback: context` - вызов функции при неуспешном выполнении задачи
- `on_retry_callback: context` - вызов функции при ретаре задачи
Если передать эти параметры в сам даг `DAG(...)`, то срабатывать они будут не в рамках одной задачи, а в рамках всего дага
```python
from airflow import DAG
from airflow.operators.python import PythonOperator
from airflow.providers.telegram.operators.telegram import TelegramOperator
from datetime import datetime

# Функция, которая будет выбрасывать исключение
def success():
    pass

# Функция для обработки ошибки и отправки сообщения
def on_success_callback(context):
    send_message = TelegramOperator(
        task_id='send_message_telegram',
        telegram_conn_id='telegram_id',
        chat_id='-1001525736146',
        text='Hello from Airflow!',
        dag=dag)
    return send_message.execute(context=context)

# Определение DAG
default_args = {
    'on_success_callback': on_success_callback  # Устанавливаем функцию для обработки ошибки
}

dag = DAG(
    dag_id='0_Examples_5_3_1_notification',
    default_args=default_args,
    schedule_interval=None,  # Только ручной запуск
    start_date=datetime(2023, 1, 1)
)
    
    # PythonOperator, который выбрасывает исключение
python_task = PythonOperator(
    task_id='raise_exception_task',
    python_callable=success,
    dag=dag
)

python_task
```